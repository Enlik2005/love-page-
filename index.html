<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ë—É–¥–µ—à—å –º–æ–µ–π –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π? üíå</title>

  <style>
    :root{
      --bg1:#ffe6f2;
      --bg2:#ffd1e6;
      --card:#ffffffcc;
      --stroke:#ffb3d6;
      --text:#3b1b2a;
      --muted:#7a3a56;
      --accent1:#ff4fa3;
      --accent2:#ff8fc6;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background:
        radial-gradient(900px 600px at 30% 15%, #fff, transparent 60%),
        radial-gradient(900px 600px at 70% 20%, #fff, transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      overflow:hidden;
    }

    /* –ø–ª–∞–≤–∞—é—â–∏–µ —Å–µ—Ä–¥–µ—á–∫–∏ —Ñ–æ–Ω */
    .hearts{
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.18;
      background:
        radial-gradient(circle at 10% 20%, #ff6fb8 0 6px, transparent 7px),
        radial-gradient(circle at 40% 10%, #ff6fb8 0 5px, transparent 6px),
        radial-gradient(circle at 80% 25%, #ff6fb8 0 7px, transparent 8px),
        radial-gradient(circle at 70% 70%, #ff6fb8 0 6px, transparent 7px),
        radial-gradient(circle at 25% 75%, #ff6fb8 0 7px, transparent 8px);
      filter: blur(.2px);
      animation: floatBg 10s ease-in-out infinite;
    }
    @keyframes floatBg{
      0%,100%{ transform: translateY(0); }
      50%{ transform: translateY(10px); }
    }

    .card{
      width:min(92vw, 460px);
      background: var(--card);
      border: 1px solid rgba(255,79,163,.25);
      border-radius: 26px;
      padding: 22px;
      box-shadow: 0 18px 60px rgba(255,79,163,.18);
      position:relative;
      text-align:center;
      backdrop-filter: blur(8px);
    }

    h1{
      margin: 6px 0 8px;
      font-size: 22px;
      letter-spacing: .2px;
    }
    p{
      margin: 0 0 14px;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.35;
    }

    .badge{
      display:inline-flex;
      gap:8px;
      align-items:center;
      font-weight:800;
      font-size: 12px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px dashed rgba(255,79,163,.35);
      background: rgba(255,255,255,.7);
      color: rgba(59,27,42,.9);
      margin-bottom: 10px;
    }

    .controls{ margin-top: 10px; }

    .btn{
      border:0;
      border-radius: 16px;
      padding: 14px 18px;
      font-size: 16px;
      font-weight: 900;
      cursor: pointer;
      user-select:none;
      transition: transform .08s ease, filter .12s ease;
      will-change: transform;
    }
    .btn:active{ transform: scale(.98); }

    #yes{
      background: linear-gradient(135deg, var(--accent1), var(--accent2));
      color: #fff;
      box-shadow: 0 14px 28px rgba(255,79,163,.28);
      margin-bottom: 10px;
    }

    /* –∑–æ–Ω–∞ –æ—Ö–æ—Ç—ã –Ω–∞ "–Ω–µ—Ç" */
    .arena{
      position:relative;
      height: 220px;
      border-radius: 22px;
      background: rgba(255,255,255,.55);
      border: 1px dashed rgba(255,79,163,.32);
      overflow:hidden;
      touch-action: manipulation;
    }

    #no{
      position:absolute;
      left: 55%;
      top: 60%;
      transform: translate(-50%,-50%);
      background: rgba(255,255,255,.85);
      color: rgba(59,27,42,.95);
      border: 1px solid rgba(255,79,163,.35);
      box-shadow: 0 10px 18px rgba(255,79,163,.14);
      backdrop-filter: blur(6px);
    }

    /* –∑–ª–µ–µ: –¥—Ä–æ–∂—å + ‚Äú–ø—Ä—ã–∂–æ–∫‚Äù */
    .panic{
      animation: panic .12s linear 2;
      filter: saturate(1.2);
    }
    @keyframes panic{
      0%{ transform: translate(var(--tx), var(--ty)) rotate(0deg) scale(1); }
      25%{ transform: translate(calc(var(--tx) + 2px), calc(var(--ty) - 2px)) rotate(-2deg) scale(1.02); }
      50%{ transform: translate(calc(var(--tx) - 2px), calc(var(--ty) + 2px)) rotate(2deg) scale(0.98); }
      75%{ transform: translate(calc(var(--tx) + 2px), calc(var(--ty) + 2px)) rotate(-2deg) scale(1.02); }
      100%{ transform: translate(var(--tx), var(--ty)) rotate(0deg) scale(1); }
    }

    /* —Ä–µ–∑—É–ª—å—Ç–∞—Ç */
    .result{ display:none; margin-top: 14px; }
    .result img{
      width: 100%;
      max-width: 340px;
      border-radius: 22px;
      border: 1px solid rgba(255,79,163,.25);
      box-shadow: 0 18px 48px rgba(255,79,163,.18);
    }
    .caption{
      margin-top: 10px;
      font-size: 16px;
      font-weight: 900;
      color: rgba(59,27,42,.95);
    }
    .tiny{
      margin-top: 8px;
      font-size: 12px;
      color: rgba(122,58,86,.85);
    }

    /* –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ */
    canvas#confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index: 9999;
    }
  </style>
</head>

<body>
  <div class="hearts"></div>
  <canvas id="confetti"></canvas>

  <div class="card">
    <div class="badge">üíå–û—Ç –ï–Ω–ª–∏–∫</div>
    <h1 id="q">–ë—É–¥–µ—à—å –º–æ–µ–π –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π?ü•∫üëâüëà</h1>
    <p id="sub">–í—ã–±–æ—Ä –ø—Ä–æ—Å—Ç–æ–π‚Ä¶ –Ω–æ ‚Äú–ù–µ—Ç‚Äù –ø–æ—á–µ–º—É-—Ç–æ –Ω–µ –¥–∞–µ—Ç—Å—è)</p>

    <div class="controls" id="controls">
      <button class="btn" id="yes">–î–∞üíñ</button>
    </div>

    <div class="arena" id="arena" aria-label="–∏–≥—Ä–æ–≤–∞—è –∑–æ–Ω–∞">
      <button class="btn" id="no">–ù–µ—ÇüôÉ</button>
    </div>

    <div class="result" id="result">
      <img id="gif" alt="gif" />
      <div class="caption" id="caption">–£–†–ê–ê–ê! –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç–µ–ø–µ—Ä—å —Ç—ã –º–æ—è –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞üíû</div>
      <div class="tiny">–¢—ã –µ—â–µ —Ç—É—Ç? –ò–¥–∏ —Å–∫–æ—Ä–µ–µ –∑–≤–∞—Ç—å –º–µ–Ω—è –Ω–∞ —Å–≤–∏–¥–∞–Ω–∏–µ)üëâüëà</div>
    </div>
  </div>

  <!-- –ú—É–∑—ã–∫–∞: –≤—Å—Ç–∞–≤—å —Å–≤–æ–π mp3-—Ñ–∞–π–ª —Å—Å—ã–ª–∫–æ–π –∏–ª–∏ –æ—Å—Ç–∞–≤—å —ç—Ç—É -->
  <audio id="music" preload="auto">
    <source src="https://github.com/Enlik2005/love-page-/blob/main/Dzhordzh_Majkl_-_Careless_Whisper_(mp3.pm).mp3">
  </audio>

  <script>
    // ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
    const GIF_URL = "https://media.giphy.com/media/MDJ9IbxxvDUQM/giphy.gif";

    // ‚Äú–ù–µ—Ç‚Äù –µ—â—ë –∂—ë—Å—Ç—á–µ:
    const TRIGGER_RADIUS = 170;      // —É–±–µ–≥–∞–µ—Ç —Ä–∞–Ω—å—à–µ
    const EVASION_DISTANCE = 210;    // –¥–∞–ª—å—à–µ –ø—Ä—ã–≥–∞–µ—Ç
    const TELEPORT_CHANCE = 0.45;    // —á–∞—â–µ —Ç–µ–ª–µ–ø–æ—Ä—Ç
    const SHRINK_CHANCE = 0.35;      // –∏–Ω–æ–≥–¥–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
    const SPIN_CHANCE = 0.25;        // –∏–Ω–æ–≥–¥–∞ –∫—Ä—É—Ç–∏—Ç—Å—è
    const TEXTS = ["–ù–µ—ÇüôÉ", "–ù–µ–µ–µ—Çüòà", "–ù–µ –ø–æ–π–º–∞–µ—à—åüòù", "–•–∞—Ö–∞üòè", "–ú–∏–º–æüíÖ"];
    // =====================

    const arena = document.getElementById('arena');
    const noBtn = document.getElementById('no');
    const yesBtn = document.getElementById('yes');
    const controls = document.getElementById('controls');
    const result = document.getElementById('result');
    const gif = document.getElementById('gif');
    const caption = document.getElementById('caption');
    const sub = document.getElementById('sub');
    const music = document.getElementById('music');

    // ---- —É—Ç–∏–ª–∏—Ç—ã ----
    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

    function randomPos(){
      const pad = 10;
      const a = arena.getBoundingClientRect();
      const b = noBtn.getBoundingClientRect();
      const maxX = a.width  - b.width  - pad;
      const maxY = a.height - b.height - pad;
      return { x: Math.random() * maxX + pad, y: Math.random() * maxY + pad, a, b, pad };
    }

    function setNoPos(x,y){
      noBtn.style.left = x + "px";
      noBtn.style.top  = y + "px";
      noBtn.style.transform = "none";
      noBtn.style.setProperty("--tx","0px");
      noBtn.style.setProperty("--ty","0px");
    }

    function spiceNo(){
      // –º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç
      noBtn.textContent = TEXTS[Math.floor(Math.random()*TEXTS.length)];

      // –∏–Ω–æ–≥–¥–∞ —É–º–µ–Ω—å—à–∞–µ–º –∫–Ω–æ–ø–∫—É (–∑–ª–µ–µ)
      if (Math.random() < SHRINK_CHANCE){
        noBtn.style.transform = "scale(0.85)";
        setTimeout(() => { noBtn.style.transform = "none"; }, 180);
      }

      // –∏–Ω–æ–≥–¥–∞ –∫—Ä—É—Ç–∏–º
      if (Math.random() < SPIN_CHANCE){
        noBtn.style.transform = "rotate(" + (Math.random() < 0.5 ? "-" : "") + "12deg)";
        setTimeout(() => { noBtn.style.transform = "none"; }, 180);
      }
    }

    function panicAnim(){
      noBtn.classList.remove("panic");
      void noBtn.offsetWidth;
      noBtn.classList.add("panic");
    }

    // —É–±–µ–≥–∞–µ—Ç –ø–æ –≤–µ–∫—Ç–æ—Ä—É –æ—Ç –ø–∞–ª—å—Ü–∞/–∫—É—Ä—Å–æ—Ä–∞
    function evade(clientX, clientY){
      const a = arena.getBoundingClientRect();
      const b = noBtn.getBoundingClientRect();

      const btnCenterX = (b.left - a.left) + b.width/2;
      const btnCenterY = (b.top  - a.top ) + b.height/2;

      const px = clientX - a.left;
      const py = clientY - a.top;

      const dx = btnCenterX - px;
      const dy = btnCenterY - py;
      const dist = Math.hypot(dx, dy) || 1;

      if (dist > TRIGGER_RADIUS) return;

      const ux = dx / dist;
      const uy = dy / dist;

      // –±–∞–∑–æ–≤—ã–π –ø—Ä—ã–∂–æ–∫
      let targetX = (btnCenterX + ux * EVASION_DISTANCE) - b.width/2;
      let targetY = (btnCenterY + uy * EVASION_DISTANCE) - b.height/2;

      // —Ç–µ–ª–µ–ø–æ—Ä—Ç
      if (Math.random() < TELEPORT_CHANCE){
        targetX = (a.width  - (b.left - a.left) - b.width);
        targetY = (a.height - (b.top  - a.top ) - b.height);
      }

      // –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ
      const pad = 8;
      targetX = clamp(targetX, pad, a.width  - b.width  - pad);
      targetY = clamp(targetY, pad, a.height - b.height - pad);

      spiceNo();
      panicAnim();
      setNoPos(targetX, targetY);
    }

    // –ü–ö: –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –º—ã—à–∏
    arena.addEventListener("mousemove", e => evade(e.clientX, e.clientY));

    // –¢–µ–ª–µ—Ñ–æ–Ω: –ø–∞–ª–µ—Ü
    arena.addEventListener("touchstart", e => {
      const t = e.touches[0];
      evade(t.clientX, t.clientY);
    }, { passive:true });

    arena.addEventListener("touchmove", e => {
      const t = e.touches[0];
      evade(t.clientX, t.clientY);
    }, { passive:true });

    // –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞–∂–∞—Ç—å = –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Ä–∞–Ω–¥–æ–º-—Å–∫–∞—á–æ–∫
    ["pointerdown","mouseenter","touchstart"].forEach(evt => {
      noBtn.addEventListener(evt, (e) => {
        e.preventDefault?.();
        const { x,y } = randomPos();
        spiceNo();
        panicAnim();
        setNoPos(x,y);
      }, { passive:false });
    });

    // ---- –ö–û–ù–§–ï–¢–¢–ò ----
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    let pieces = [], animId = null;

    function resize(){
      canvas.width = window.innerWidth * devicePixelRatio;
      canvas.height = window.innerHeight * devicePixelRatio;
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }
    window.addEventListener("resize", resize);
    resize();

    function makeConfetti(count=260){
      pieces = Array.from({length: count}, () => ({
        x: Math.random() * window.innerWidth,
        y: -20 - Math.random()*300,
        r: 4 + Math.random()*7,
        vx: -2.5 + Math.random()*5,
        vy: 3.5 + Math.random()*6.5,
        rot: Math.random()*Math.PI,
        vr: -0.2 + Math.random()*0.4,
        color: `hsla(${Math.floor(Math.random()*360)}, 95%, 65%, 0.95)`,
        shape: Math.random() < 0.55 ? "rect" : "circle"
      }));
    }

    function draw(){
      ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
      for (const p of pieces){
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        p.vy += 0.02;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = p.color;

        if (p.shape === "rect"){
          ctx.fillRect(-p.r, -p.r/2, p.r*2, p.r);
        } else {
          ctx.beginPath();
          ctx.arc(0,0,p.r/1.6,0,Math.PI*2);
          ctx.fill();
        }
        ctx.restore();
      }
      const alive = pieces.some(p => p.y < window.innerHeight + 50);
      if (alive) animId = requestAnimationFrame(draw);
      else {
        cancelAnimationFrame(animId);
        animId = null;
        ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
      }
    }

    function launchConfetti(){
      makeConfetti(300);
      if (!animId) draw();
    }

    // ---- –î–ê ----
    yesBtn.addEventListener("click", async () => {
      // –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
      gif.src = GIF_URL;
      caption.textContent = "–£–†–ê–ê–ê! –¢—ã –º–æ—è –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞ üíû";
      result.style.display = "block";
      arena.style.display = "none";
      controls.style.display = "none";
      sub.textContent = "–Ø –∑–Ω–∞–ª–∞) –° –¥–Ω—ë–º –í–∞–ª–µ–Ω—Ç–∏–Ω–∞ —Ç–µ–±—è!";

      // –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
      launchConfetti();

      // –º—É–∑—ã–∫–∞ (–ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ ‚Äî –º–æ–∂–Ω–æ)
      try{
        music.volume = 0.75;
        await music.play();
      }catch(err){
        // –µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä –≤—Å—ë —Ä–∞–≤–Ω–æ –±–ª–æ–∫–Ω—É–ª ‚Äî –Ω–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ
        sub.textContent = "–Ø –∑–Ω–∞–ª–∞üòè";
        controls.style.display = "block";
        controls.innerHTML = '<button class="btn" id="yes2">–í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É üéµ</button>';
        document.getElementById("yes2").addEventListener("click", async ()=>{
          try{ await music.play(); }catch(e){}
          controls.style.display = "none";
        });
      }
    });

    // —Å—Ç–∞—Ä—Ç
    const start = randomPos();
    setNoPos(start.x, start.y);
  </script>
</body>
</html>
